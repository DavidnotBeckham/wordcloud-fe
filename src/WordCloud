import React, { useEffect, useState } from 'react';
import axios from 'axios';
import WordCloud from 'react-wordcloud';

// Define options for the WordCloud
const options = {
  colors: ['#793c3c', '#E1B4B4', '#DB6E6E', '#A85454'],
  enableTooltip: false, // Disable tooltip
  fontFamily: 'impact',
  fontSizes: [20, 60],
  rotations: 2,
  rotationAngles: [-90, 0],
  scale: 'sqrt',
  transitionDuration: 1000,
};

const WordCloudComponent = ({ movie }) => {
  const [defaultWords, setDefaultWords] = useState([]);

  // Function to handle word click
  const wordClickHandler = (word) => {
    console.log('Word clicked:', word);
    // Handle word click functionality here
  };

  // Fetch the word cloud data from the server
  useEffect(() => {
    const getWordCloud = async () => {
      const url = `${SERVER_URL}/community/movie/${movie.id}/review/wordcloud/`;

      try {
        const response = await axios.get(url);
        setDefaultWords(response.data);
      } catch (error) {
        console.error('Error fetching word cloud data:', error);
      }
    };

    getWordCloud();
  }, [movie.id]); // Re-run effect when movie.id changes

  return (
    <div>
      {defaultWords.length > 0 && (
        <WordCloud
          words={defaultWords.map(({ name, value }) => ({ text: name, value }))}
          options={options}
          callbacks={{
            onWordClick: wordClickHandler, // Register the click handler
          }}
        />
      )}
    </div>
  );
};

export default WordCloudComponent;
